<hr>

<p>
&#36825;&#31687;&#35770;&#25991;&#26159;&#22312;&#30475; <a href="http://www.zmonster.me/hmn_for_qa.html" rel="noopener noreferrer" target="_blank">Hierarchical Memory Networks for Answer Selection on Unknown Words</a> &#26102;&#36861;&#36807;&#21435;&#30340; &mdash;&mdash; &#36825;&#31687;&#35770;&#25991;&#37324;&#26377;&#20123;&#19996;&#35199;&#35762;&#30340;&#19981;&#26126;&#19981;&#30333;&#65292;&#36824;&#22909;&#23427;&#37324;&#38754;&#35828;&#26126;&#19968;&#20123;&#24605;&#24819;&#26469;&#33258;&#21738;&#37324;&#12290;
</p>

<p>
&#35770;&#25991;&#26631;&#39064;&#20026; "End-to-End Memory Networks" &#65292;&#24456;&#26174;&#28982;&#36825;&#31687;&#35770;&#25991;&#26159;&#22522;&#20110; Memory Networks &#26469;&#20570;&#20102;&#19968;&#20123;&#24037;&#20316;&#65292;&#25353;&#29031;&#24815;&#20363;&#65292;&#35770;&#25991;&#22312;&#24320;&#22836;&#35828;&#20102;&#19968;&#20123;&#21407;&#22987;&#30340; Memory Networks &#30340;&#32570;&#28857;:
</p>
<ol>
<li>Memory Networks &#38590;&#20197;&#36827;&#34892; BP &#35757;&#32451;</li>
<li>Memory Networks &#38656;&#35201;&#26356;&#22810;&#30340; supervision(&#36825;&#20010;&#27809;&#22826;&#25026;&#65292;&#22238;&#22836;&#25226; Memory Networks &#20877;&#30475;&#19968;&#19979;)</li>
</ol>

<p>
&#27169;&#22411;&#30340;&#22522;&#26412;&#32467;&#26500;&#22914;&#19979;&#22270;&#25152;&#31034;&#12290;
</p>


<div>
<p><img src="http://www.zmonster.me/assets/img/memn2n_single_layer.png" alt="memn2n_single_layer.png" referrerpolicy="no-referrer" loading="lazy">
</p>
</div>

<p>
&#27169;&#22411;&#30340;&#36755;&#20837;&#21253;&#21547;&#20004;&#37096;&#20998;&#65292;&#19968;&#20010;&#26159;&#22270;&#24038;&#31471;&#37027;&#20010;&#12300;Sentences&#12301;&#65292;&#21363;&#30001;&#22810;&#20010;&#21477;&#23376;&#32452;&#25104;&#30340;&#20869;&#23481;&#65292;&#36825;&#20123;&#21477;&#23376;&#20250;&#34987;&#36755;&#20837;&#21040;&#32593;&#32476;&#20013;&#24182;&#20648;&#23384;&#20026;&#12300;memory&#12301;&#65292;&#21487;&#20197;&#35748;&#20026;&#26159;&#22312;&#26816;&#32034;/&#38382;&#31572;&#26102;&#30340;&#21382;&#21490;&#20449;&#24687;&#25110;&#32773;&#35828;&#19978;&#19979;&#25991;&#65307;&#21478;&#19968;&#37096;&#20998;&#26159; query &#25110;&#35828; question&#65292;&#23601;&#26159;&#22270;&#20013;&#19979;&#31471;&#37027;&#20010; q&#65292;&#20063;&#26159;&#19968;&#20010;&#21477;&#23376;&#12290;&#27169;&#22411;&#26368;&#21518;&#30340;&#36755;&#20986;&#20063;&#26159;&#19968;&#20010;&#21477;&#23376;&#12290;
</p>

<p>
&#27169;&#22411;&#30340;&#36755;&#20986;&#65292;&#25353;&#29031;&#25105;&#23545;&#36825;&#24352;&#22270;&#30340;&#29702;&#35299;&#65292;&#24212;&#35813;&#26159;&#19968;&#20010;&#32463;&#36807; softmax &#30340; d &#32500;&#21521;&#37327;(d &#26159; vocabulary &#30340;&#22823;&#23567;)&#65292;&#20294;&#26159;&#36825;&#26679;&#30340;&#35805;&#23601;&#21482;&#33021;&#36755;&#20986;&#19968;&#20010;&#35789;&#20102;&#65311;&#20174;&#21518;&#38754;&#30340;&#23454;&#39564;&#37096;&#20998;&#26469;&#30475;&#30830;&#23454;&#26159;&#36825;&#26679;&#30340;&#65292;&#24635;&#24863;&#35273;&#36825;&#26679;&#30340;&#35805;&#24182;&#19981;&#26159;&#24456;&#36866;&#29992;&#20110;&#24120;&#35268;&#30340; QA &#20219;&#21153;&#20102;&#12290;
</p>

<p>
&#36755;&#20837;&#30340; Sentences&#65292;&#39318;&#20808;&#36890;&#36807; embedding &#30697;&#38453; A &#24471;&#21040; input memory&#12290;&#20854;&#23454;&#23601;&#26159;&#23558;&#27599;&#19968;&#20010;&#21477;&#23376; encode &#25104;&#19968;&#20010;&#21521;&#37327;&#65292;&#20063;&#23601;&#26159;&#22270;&#19978;&#30340; \(m_{i}\)&#65292;&#36825;&#20123; \(m_{i}\) &#32452;&#21512;&#36215;&#26469;&#23601;&#24471;&#21040; input memory&#65292;&#20063;&#23601;&#26159;&#28034;&#19978;&#26631;&#20026; <b>Input</b> &#30340;&#37027;&#22359;&#30697;&#24418; M&#12290;&#38382;&#39064; q &#21516;&#26679;&#36890;&#36807; embedding &#30697;&#38453; B &#26469; encode &#25104;&#19968;&#20010;&#21521;&#37327; u&#65292;&#28982;&#21518;&#29992; u &#21644; M &#20839;&#31215;&#24471;&#21040;&#19968;&#20010;&#26435;&#20540;&#21521;&#37327;:
</p>

<p>
\[p=softmax(u^{T}M)\]
</p>

<p>
&#25509;&#30528;&#65292;&#36755;&#20837;&#30340; Sentences &#36890;&#36807;&#21478;&#22806;&#19968;&#20010; embedding &#30697;&#38453; C &#24471;&#21040;&#21478;&#22806;&#19968;&#20010; memory &#34920;&#31034;&#65292;&#20063;&#23601;&#26159;&#22270;&#19978;&#26631;&#20026; <b>Output</b> &#30340;&#37027;&#22359;&#30697;&#24418; C&#65292;&#28982;&#21518;&#29992;&#19978;&#19968;&#27493;&#24471;&#21040;&#30340;&#26435;&#20540;&#21521;&#37327;&#26469;&#23545; C &#36827;&#34892;&#21152;&#26435;&#27714;&#21644;:
</p>

<p>
\[o=\sum_{i}p_{i}c_{i}\]
</p>

<p>
&#23545;&#20110;&#36825;&#37096;&#20998;&#65292;&#25105;&#30340;&#29702;&#35299;&#26159;&#65292;u &#21644; M &#30340;&#20839;&#31215;&#30456;&#24403;&#20110;&#19968;&#20010; attention&#65292;&#24471;&#21040; attention &#21518;&#65292;&#23601;&#29992;&#26469;&#22312;&#29992;&#20110;&#36755;&#20986;&#30340; memory &#20063;&#23601;&#26159; C &#20013;&#36827;&#34892;&#26816;&#32034;&#24471;&#21040;&#36755;&#20986;&#32467;&#26524;&#12290;&#19981;&#36807;&#36824;&#26159;&#26377;&#20123;&#22320;&#26041;&#19981;&#22826;&#26126;&#30333;&#65292;&#27604;&#22914;&#35828;&#21453;&#26144;&#22312;&#32593;&#32476;&#32467;&#26500;&#19978;&#65292;u &#21644; M &#30340;&#20839;&#31215;&#26159;&#24590;&#20040;&#20307;&#29616;&#30340;&#65311;&#36755;&#20837;&#36830;&#25509;&#20004;&#20010; embedding &#30697;&#38453;&#21448;&#26159;&#24590;&#20040;&#20307;&#29616;&#30340;&#65311;
</p>

<p>
&#22312;&#24471;&#21040;&#36755;&#20986;&#21521;&#37327; o &#21518;&#65292;&#25353;&#29702;&#26469;&#35828;&#30452;&#25509; softmax &#23601;&#21487;&#20197;&#24471;&#21040;&#32467;&#26524;&#21543;&#65292;&#20294;&#26159;&#36825;&#37324;&#21364;&#21644; question &#30340;&#21521;&#37327; u &#20570;&#20102;&#19968;&#20010;&#21152;&#27861;&#25165;&#36827;&#34892; softmax&#65292;&#19981;&#26159;&#24456;&#25026;&#65292;&#20063;&#35768;&#21644; ResNet &#30340;&#37027;&#20010; residual connection &#26159;&#21516;&#26679;&#30340;&#24605;&#24819;&#65311;&#20294;&#26159; 2015 &#24180; 3 &#26376;&#20221;(&#36825;&#31687;&#35770;&#25991;&#30340;&#21457;&#34920;&#26102;&#38388;)&#30340;&#26102;&#20505; ResNet &#36824;&#27809;&#26377;&#27491;&#24335;&#21457;&#34920;&#21543;&#12290;
</p>

<p>
&#20197;&#19978;&#23601;&#26159;&#21333;&#23618;&#26102;&#30340;&#24773;&#20917;&#65292;&#22810;&#23618;&#30340;&#26102;&#20505;&#23601;&#29992;&#21069;&#19968;&#23618;&#30340;(&#26410;&#32463;&#36807; softmax &#30340;)&#36755;&#20986;&#20316;&#20026;&#26412;&#23618;&#30340;&#36755;&#20837;&#21521;&#37327; u&#65292;&#21363;
</p>

<p>
\[u^{k+1} = o^{k}+u^{k}\]
</p>

<p>
&#19968;&#22270;&#32988;&#21315;&#35328;:
</p>


<div>
<p><img src="http://www.zmonster.me/assets/img/memn2n_multi_layer.png" alt="memn2n_multi_layer.png" referrerpolicy="no-referrer" loading="lazy">
</p>
</div>

<p>
&#22312;&#22810;&#23618;&#32467;&#26500;&#30340;&#26102;&#20505;&#65292;&#20316;&#32773;&#21448;&#23545; "weight typing" &#20570;&#20102;&#19981;&#21516;&#30340;&#23581;&#35797; &mdash;&mdash; &#19981;&#30693;&#36947;&#12300;weight typing&#12301;&#35813;&#24590;&#20040;&#32763;&#35793;&#65292;&#19988;&#30475;&#19979;&#25991;&#21543;&#12290;
</p>

<p>
&#21487;&#20197;&#30475;&#21040;&#65292;&#22312;&#19978;&#38754;&#30340;&#22810;&#23618;&#32593;&#32476;&#32467;&#26500;&#20013;&#65292;&#27599;&#19968;&#23618;&#37117;&#26377;&#19968;&#20010; A &#21644; C&#65292;&#23545; A &#21644; C &#30340;&#22788;&#29702;&#65292;&#26377;&#20004;&#31181;&#26041;&#24335;:
</p>
<ol>
<li>Adjacent: &#23558;&#21069;&#19968;&#23618;&#30340;&#36755;&#20986; embedding &#30697;&#38453; C &#20316;&#20026;&#26412;&#23618;&#30340;&#36755;&#20837; embedding &#30697;&#38453; A: \(A^{k+1}=C^{k}\)</li>
<li>Layer-wise: &#20687; RNN &#19968;&#26679;&#65292;&#25152;&#26377;&#36755;&#20837; embedding &#30697;&#38453; A &#20849;&#20139;&#21442;&#25968;: \(A^{1}=A^{2}=...=A^{K}\)&#65292;&#36755;&#20986;&#30697;&#38453; C &#21516;&#29702;</li>
</ol>

<p>
&#22312;&#23545;&#21477;&#23376;&#30340; encode &#19978;&#65292;&#20063;&#26377;&#20004;&#31181;&#19981;&#21516;&#30340;&#22788;&#29702;&#26041;&#24335;:
</p>
<ol>
<li>BoW: &#31616;&#21333;&#30340;&#23558;&#21477;&#23376;&#20013;&#27599;&#20010;&#35789;&#30340; embedding &#32047;&#21152;&#36215;&#26469;: \(m_{i}=\sum_{j}Ax_{ij}\)&#65292;u &#21644; \(c_{i}\) &#30340;&#35745;&#31639;&#21516;&#29702;</li>
<li>position encoding: \(m_{i}=\sum_{j}l_{j}\cdot Ax_{ij}\)&#65292;&#36825;&#37324;&#30340; \(l_{j}\) &#23601;&#26159;&#25152;&#35859;&#30340;&#21453;&#26144;&#20102;&#35789;&#24207;&#30340; position encoding&#65292;&#23427;&#21644;&#21518;&#38754;&#30340;&#20540;&#36827;&#34892; element-wise &#30340;&#20056;&#27861;&#32780;&#19981;&#26159;&#20839;&#31215;&#65292;&#32780;&#36825;&#20010; position encoding &#30340;&#35745;&#31639;&#26041;&#27861;&#26159;: \(l_{kj}=(1-j/J)-(k/d)(1-2j/J)\)&#65292;&#20854;&#20013; j &#26159;&#35789;&#22312;&#21477;&#23376;&#20013;&#30340;&#20301;&#32622;&#65292;J &#26159;&#21477;&#23376;&#30340;&#38271;&#24230;&#65292;k &#26159;&#36825;&#20010;&#35789;&#30340; vocabulary id&#65292;d &#26159; vocabulary &#30340;&#22823;&#23567;&#12290;</li>
</ol>

<p>
&#27492;&#22806;&#23601;&#26159; Sentences &#20013;&#30340;&#21477;&#23376;&#20043;&#38388;&#20063;&#26159;&#26377;&#27425;&#24207;&#30340;&#65292;&#20026;&#20102;&#21453;&#26144;&#36825;&#20010;&#27425;&#24207;&#65292;&#21448;&#22312;&#35745;&#31639; \(m_{i}\) &#21644; \(c_{i}\) &#26102;&#21152;&#20102;&#19968;&#20010;&#39069;&#22806;&#30340;&#21483;&#20570; temporal encoding &#30340;&#19996;&#35199;&#65292;&#20998;&#21035;&#35760;&#20026; \(T_{A}(i)\) &#21644; \(T_{C}(i)\):
</p>

<p>
\[m_{i}=\sum_{j}Axij + T_{A}(i)\]
</p>

<p>
&#20294;&#26159;&#24182;&#27809;&#26377;&#35828; \(T_{A}(i)\) &#21644; \(T_{C}(i)\) &#26159;&#22914;&#20309;&#34920;&#29616;&#30340;&#65292;&#21482;&#26159;&#24102;&#20102;&#19968;&#21477;: Both \(T_{A}\) and \(T_{C}\) are learnd during training&#12290;&#21478;&#22806;&#65292;&#22312;&#27169;&#22411;&#20013;&#65292;&#21477;&#23376;&#30340;&#27425;&#24207;&#23545;&#30495;&#23454;&#30340;&#27425;&#24207;&#32780;&#35328;&#26159;&#20498;&#24207;&#30340;&#12290;
</p>

<p>
&#20316;&#32773;&#25552;&#20986;&#36825;&#20010;&#27169;&#22411;&#38500;&#20102;&#29992;&#22312; QA &#19978;&#22806;&#65292;&#36824;&#22312;&#35821;&#35328;&#27169;&#22411;&#19978;&#20570;&#20102;&#23454;&#39564;&#12290;&#22312;&#20570;&#35821;&#35328;&#27169;&#22411;&#26102;&#65292;&#26159;&#27809;&#26377; question/query &#30340;&#65292;&#25152;&#20197; u &#34987;&#35774;&#32622;&#20026;&#19968;&#20010;&#24120;&#37327;&#30340;&#21521;&#37327;(&#20540;&#37117;&#20026; 0.1)&#65307;&#28982;&#21518;&#27599;&#20010; \(m_{i}\) &#21644; \(c_{i}\) &#37117;&#26159;&#23545;&#24212;&#19968;&#20010;&#35789;&#32780;&#19981;&#26159;&#19968;&#20010;&#21477;&#23376;&#20102;&#65292;&#22240;&#20026; LM &#26159; word-level &#30340;&#38382;&#39064;&#22043;&#12290;
</p>

<p>
&#26368;&#21518;&#24635;&#32467;&#19968;&#19979;&#65292;&#26412;&#25991;&#30340;&#20027;&#35201;&#36129;&#29486;&#26159;&#22686;&#24378;&#20102;&#21407;&#22987;&#30340; Memory Networks&#65292;&#35753;&#20854;&#31216;&#20026;&#19968;&#20010;&#31471;&#21040;&#31471;&#30340;&#27169;&#22411;&#65292;&#33021;&#26356;&#26041;&#20415;&#22320;&#20351;&#29992; BP &#26041;&#27861;&#36827;&#34892;&#35757;&#32451;&#12290;
</p>

<p>
&#23601;&#37233;&#65281;
</p>