#+TITLE: Config
#+begin_src emacs-lisp
;; $DOOMDIR/config.el -*- lexical-binding: t; -*-
#+end_src

* ğŸ¬ TODO personal data

#+begin_src emacs-lisp
(setq user-full-name "Pei Yu"
      user-mail-address "yp9106@outlook.com")
#+END_SRC

* â˜¯ DONE Global variables
æ³¨æ„åˆ° =doom-privae-dir= æ˜¯ doom çš„ä¸ªäººé…ç½®æ–‡ä»¶å¤¹ï¼Œä¸€èˆ¬ä¸º =~/.doom.d/=
** rime path
è®°å½•äº† [[https://wiki.archlinux.org/index.php/Fcitx5][archlinux fcitx5]] ä¸­ [[https://github.com/fcitx/fcitx5-rime][fcitx5-rime]] è¾“å…¥æ³•çš„ä½ç½®
#+begin_src emacs-lisp :tangle yes
(setq rime-user-data-dir "~/.local/share/fcitx5/rime/")
#+end_src

** mathpix path
è®°å½•äº† [[https://github.com/jethrokuan/mathpix.el][jethrokuan/mathpix.el]] å­˜å‚¨ä½ç½®,

#+begin_src emacs-lisp :tangle yes
(setq mathpix-dir (concat doom-private-dir "mathpix/"))
(setq mathpix-app-id (with-temp-buffer (insert-file-contents "./secrets/mathpix-app-id") (buffer-string))
      mathpix-app-key (with-temp-buffer (insert-file-contents "./secrets/mathpix-app-key") (buffer-string)))
#+end_src
** org-mode path
è®°å½•äº† org-mode ç›¸å…³çš„è·¯å¾„ä½ç½®.
*** org-files
è®°å½•äº†æ ‡å‡†çš„ org-mode ç›¸å…³çš„æ–‡ä»¶ä½ç½®
#+begin_src emacs-lisp
(setq org-directory "~/Dropbox/Org/")
#+end_src
*** org-things
- è®°å½•äº†
  + things: æ‰€æœ‰è®°å½•çš„ä¸œè¥¿
  + braindump: [[https://www.orgroam.com/][org-roam]] çš„å†…å®¹å­˜å‚¨ä½ç½®
  + project: è®°å½•å·¥ä½œé¡¹ç›®
  + image: è®°å½•å–œæ¬¢çš„å›¾ç‰‡
  + thoughts: è®°å½•ä¸çŸ¥é“ä»ä½•è€Œæ¥çš„æƒ³æ³•
  + arts: è®°å½•çœ‹åˆ°çš„å›¾ç‰‡
#+begin_src emacs-lisp
(setq py/things-dir     (concat org-directory   "things/") ;things stand for roams
      py/braindump-dir  (concat py/things-dir   "braindump/") ;second brain
      py/project-dir    (concat py/things-dir   "project/") ;projects for project files
      py/image-dir      (concat py/things-dir   "image/")   ;image stored
      py/thoughts-dir   (concat py/braindump-dir  "thoughts/") ;like roaming, but more glue
      py/arts-dir        (concat py/braindump-dir  "arts/")) ;novel, music, films, animate, comics, games, notes after reading
#+end_src
- è®°å½•äº†
  + inbox: åˆ°è„‘å­é‡Œçš„æƒ³æ³•
  + next: å¾…å¤„ç†çš„æƒ³æ³•
  + braindump-inbox: ä»inboxè½¬ç§»åˆ° [[https://www.orgroam.com/][org-roam]] çš„æƒ³æ³•
  + brain-index: è®°å½• [[https://www.orgroam.com/][org-roam]] å†…çš„æ‰€æœ‰å†…å®¹
  + thoughts: è®°å½•æƒ³æ³•çš„æ‰€æœ‰å†…å®¹
  + arts: è®°å½•æ‰€äº«å—çš„æ‰€æœ‰è‰ºæœ¯å“
#+begin_src emacs-lisp
(setq   py/inbox                (concat org-directory   "inbox.org") ;idea records
        py/next                 (concat org-directory   "next.org")  ;one-off tasks as a todolist
        py/braindump-inbox      (concat py/braindump-dir "braindump_inbox.org")
        py/braindump-index      (concat py/braindump-dir "Index.org")
        py/thoughts             (concat py/thoughts-dir "thoughts.org") ;some tempo ideas
        py/arts                 (concat py/arts-dir     "arts.org"))     ;tempo ideas of pastime
#+end_src

*** bipolar
è®°å½•è‡ªå·±å¯¹æŠ—åŒå‘æƒ…æ„Ÿéšœç¢çš„è¡¨æ ¼(æ—¶å¸¸å¤±è´¥,ä½†è¦æ°¸è¿œæ˜‚æ‰¬), è¡¨æ ¼æ¥æºæ˜¯:


#+DOWNLOADED: file:///home/py06/.doom.d/images/bipolarform.jpg @ 2021-04-13 22:00:29
[[file:images/config/bipolarform.jpg]]
#+begin_src emacs-lisp :tangle yes
(setq   py/bipolar (concat org-directory   "logs/bipolar.org"));idea records
#+end_src



* â˜¯ DONE Scratch
ç”¨è¿™ä¸ªæ¥ç¼–è¾‘æœ€åŸºæœ¬çš„ doom-emacs æ“ä½œã€‚(ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨)
#+begin_src emacs-lisp
(map! :leader :desc "doom/scratch"            "X" #'doom/open-scratch-buffer)
#+end_src


* â˜¯ DONE Appearance
** â˜¯ DONE theme
ä½¿ç”¨ doom-dracula ä¸»é¢˜
#+begin_src emacs-lisp
(setq doom-theme 'doom-dracula)
#+end_src

** â˜¯ DONE Fonts
æ— è€»åœ°æŠ„è¢­, è¿æŠ„å“ªå„¿éƒ½å¿˜äº†.
#+begin_src emacs-lisp
(setq doom-font (font-spec :family "Sarasa Mono SC Nerd" :size 14)
      doom-big-font (font-spec :family "Sarasa Mono SC Nerd" :size 20)
      doom-variable-pitch-font (font-spec :family "Monaco" :size 18))
(push "Sarasa Mono SC Nerd" doom-unicode-extra-fonts)
;; There are two ways to load a theme. Both assume the theme is installed and
;; available. You can either set `doom-theme' or manually load a theme with the
;; `load-theme' function. This is the default:
#+end_src

** â˜¯ DONE line-number
é»˜è®¤æ˜¾ç¤ºè¡Œå·
#+begin_src emacs-lisp
(setq display-line-numbers-type t)
#+end_src

** â˜¯ DONE modeline
ä¸€äº›modelineæ˜¾ç¤ºé—®é¢˜, åŸºæœ¬æ˜¯æŠ„çš„
#+begin_src emacs-lisp
(use-package doom-modeline
  :config
  ;; (use-package nyan-mode
  ;;   :hook (doom-modeline-mode . nyan-mode)
  ;;   :config
  ;;   (nyan-mode 1)
  ;;   (setq nyan-animate-nyancat t)
  ;;   (setq nyan-wavy-trail t)
  ;;   (setq mode-line-format
  ;;         (list
  ;;          '(:eval (list (nyan-create))))))
  (display-time-mode t)
  :custom
  (doom-modeline-icon (display-graphic-p))
  (doom-modeline-height 40)
  (doom-modeline-bar-width 3)
  (doom-modeline-major-mode-icon t)
  (doom-modeline-major-mode-color-icon t)
  (doom-modeline-buffer-state-icon t)
  (doom-modeline-buffer-modification-icon t)
  (doom-modeline-modal-icon t)
  (doom-modeline-buffer-encoding nil))
#+end_src

** â˜¯ DONE DONE posfroame
ä½¿ç”¨posframeè§£å†³æ˜¾ç¤ºé—®é¢˜, ä¾‹å¦‚ [[id:0d79d819-3848-4506-b2b5-5d3f55ee1721][Emacs-rime]] ä¸­çš„é—®é¢˜
#+begin_src emacs-lisp
(use-package posframe)
#+end_src


* â˜¯ DONE Frames, Worksapces and windows
** â˜¯ DONE Frame
è½¬ç§»åˆ°å¦ä¸€ä¸ªframe
#+begin_src emacs-lisp
(map! :leader
      :desc "Other frame"                       "o o" #'other-frame)
#+end_src

|-----------+-------------+-------------------|
| å¿«æ·é”®    | å‘½ä»¤        | æè¿°              |
|-----------+-------------+-------------------|
| =Spc o o= | other-frame | è·³è½¬åˆ°å¦ä¸€ä¸ª frame |
|-----------+-------------+-------------------|

** â˜¯ DONE Workspace
*** â˜¯ DONE Savespace
#+begin_src emacs-lisp
(use-package saveplace
  :hook (after-init . save-place-mode))
#+end_src
*** â˜¯ DONE Workspace selection
#+begin_src emacs-lisp
;; keybindings
(map! :leader
      :desc "Left workspace"                    "TAB ," #'+workspace/switch-left
      :desc "Right workspace"                   "TAB ." #'+workspace/switch-right
      :desc "Switch workspace"                  "TAB w" #'+workspace/switch-to)
#+end_src

|---------+-------------------------+--------------------|
| å¿«æ·é”®  | å‘½ä»¤                    | æè¿°               |
|---------+-------------------------+--------------------|
| =TAB ,= | +workspace/switch-left  | ç§»åŠ¨åˆ°ä¸Šä¸ª workspac |
| =TAB .= | +workspace/switch-right |                    |
| =TAB w= | +workspace/switch-to    |                    |
|---------+-------------------------+--------------------|

** â˜¯ DONE Ace-windows
ç”¨ ace-windows æ¥æ“ä½œçª—å£
#+begin_src emacs-lisp
(use-package ace-window
  :config
  (setq aw-keys '(?1 ?2 ?3 ?4 ?5 ?6 ?7 ?8 ?9))
  :init
  (map! :leader
        :prefix "w"
        :desc "ace-window-select" "a" #'ace-window))
#+end_src

|---------+-------------------+------|
| å¿«æ·é”®  | å‘½ä»¤              | æè¿° |
|---------+-------------------+------|
| Spc w a | ace-window-select | æµ‹è¯• |
|---------+-------------------+------|


* â˜¯ DONE Chinese
** â˜¯ DONE Emacs-rime
:PROPERTIES:
:ID:       0d79d819-3848-4506-b2b5-5d3f55ee1721
:END:
   emacs-china è®ºå›æ¨èä½¿ç”¨ emacs-rime åŒ…è¿›è¡Œä¸­æ–‡è¾“å…¥ã€‚ç”¨åæ„Ÿè§‰ï¼šUI ç°ä»£ï¼Œé€‰è¯å¿«é€Ÿï¼Œå¥½ç”¨ã€‚
#+begin_src emacs-lisp
(use-package rime
  :config
  (setq rime-user-data-dir "~/.local/share/fcitx5/rime/")
  (setq rime-posframe-properties
        (list :background-color "#333333"
              :foreground-color "#dcdccc"
              :internal-border-width 10))
  (setq rime-posframe-style 'vertical)
  (setq default-input-method "rime"
        rime-show-candidate 'posframe)
  (map! "<kp-1>" "1"
        "<kp-2>" "2"
        "<kp-3>" "3"
        "<kp-4>" "4"
        "<kp-5>" "5"
        "<kp-6>" "6"
        "<kp-7>" "7"
        "<kp-8>" "8"
        "<kp-9>" "9"
        "<kp-0>" "0")
  :bind
  (:map rime-active-mode-map
  ("<tab>" . 'rime-inline-ascii)
  :map rime-mode-map
  ("C-`" . 'rime-send-keybinding)    ;; <----
  ("M-j" . 'rime-force-enable)))
#+end_src
|--------+---------------------+--------------|
| å¿«æ·é”® | å‘½ä»¤                | æè¿°         |
|--------+---------------------+--------------|
| C-\    | toggle-input-method | åˆ‡æ¢è¾“å…¥æ³•   |
| C-:    | rime-inline-ascii   | ä½¿ç”¨è‹±æ–‡æ ‡ç‚¹ |
|--------+---------------------+--------------|

** â˜¯ DONE Avy-pinyin
:PROPERTIES:
:ID:       fb83cec2-75f4-4164-a692-2b423736016c
:END:
   åˆ©ç”¨ ace-pinyin/evil-find-char-pinyin æ¥å¿«é€ŸæŸ¥æ‰¾å­—ç¬¦, å¿«é€Ÿ vim æ“ä½œ.
#+begin_src emacs-lisp
;; search
(use-package ace-pinyin
  :after evil
  :config
  ;; å…è®¸avyè·¨çª—å£æœç´¢
  (setq avy-all-windows t)
  ;; å…¨å±€ä½¿ç”¨aceæœç´¢
  (ace-pinyin-global-mode t))

;; evil-find-char-pinyin
(use-package evil-find-char-pinyin
  :after evil
  :config
  ;;  å…è®¸avyè·¨çª—å£æœç´¢
  (setq avy-all-windows t)
  ;; å…¨å±€ä½¿ç”¨aceæœç´¢
  (evil-find-char-pinyin-mode t))
#+end_src

* ğŸ¬ TODO Coding
** ğŸ¬ TODO Latex
*** ğŸ¬ TODO forward and inverse search
    å‘å‰å‘åæœç´¢èƒ½å¤§å¹…å¢åŠ  $\LaTeX$ çš„ä¿®æ”¹é€Ÿåº¦.
    åœ¨ Emacs ä¸­çš„é…ç½®:
#+begin_src emacs-lisp
(setq TeX-auto-save t)
(setq TeX-parse-self t)
(setq-default TeX-master nil)
(setq TeX-view-program-selection '((output-pdf "Okular")))
(setq TeX-source-correlate-mode t)
(setq TeX-source-correlate-start-server t)
(setq TeX-PDF-mode t)
#+end_src

    åœ¨ Okular ä¸­çš„é…ç½®:
    Settings:   Editor settings
                    Editor:  Emacs client
                    Command: emacsclient -a emacs --no-wait +%l %f
    ä½¿ç”¨æ–¹æ³•:
    | .tex -> .pdf | ä½¿ç”¨å‘½ä»¤ TeX-preview (C-c C-v)            |
    | .pdf -> .tex | åœ¨ okular borwser æ¨¡å¼ä¸‹, Shift+Left Click |

*** ğŸ¬ TODO set engine
    è®¾ç½® xetex ä¸ºåŸºæœ¬çš„ $\LaTeX$ ç¼–è¯‘å™¨.
#+begin_src emacs-lisp
(setq TeX-engine 'xetex)
#+end_src

*** CANCELED auto-activating-snippets
- State "CANCELED"   from              [2021-04-13 Tue 22:29] \\
  æš‚æ—¶å…ˆå–æ¶ˆæ‰è¿™ä¸ª
    è®¾ç½® $\LaTeX$ çš„ yasnippet
#+begin_src emacs-lisp
;(use-package latex-auto-activating-snippets)
#+end_src

#+begin_src emacs-lisp
;(use-package auto-activating-snippets
;  :hook (latex-mode . latex-auto-activating-snippets-mode))
#+end_src

*** â˜¯ DONE cdlatex
    è®¾ç½®å¿«é€Ÿè¾“å…¥æ•°å­¦ç¬¦å· cdlatex
#+begin_src emacs-lisp
(use-package cdlatex
  :hook ((LaTeX-mode . turn-on-cdlatex)
         (org-mode . turn-on-org-cdlatex))
  :config
  (setq cdlatex-math-modify-alist
        '(( ?s  "\\mathscr" nil t nil nil )
          ( ?b  nil         nil t nil nil )
          ( ?/  "\\slashed" nil t nil nil ))))
#+end_src

*** ğŸ¬ TODO mathpix.el å‘å¸ƒå‰è¦éšè—idå’Œkey

#+begin_src emacs-lisp
(add-to-list 'load-path mathpix-dir)
(require 'mathpix)
(map! "C-x m" #'mathpix-screenshot)
#+end_src

#+begin_src emacs-lisp
(setq      mathpix-screenshot-method "scrot -s %s")
#+end_src
*** ğŸ¬ TODO COMMENT awesome pair
ä¸çŸ¥é“æœ‰å•¥ç”¨
#+begin_src emacs-lisp
(require 'awesome-pair)
(dolist (hook (list
               'c-mode-common-hook
               'c-mode-hook
               'c++-mode-hook
               'java-mode-hook
               'haskell-mode-hook
               'latex-mode-hook
               'emacs-lisp-mode-hook
               'lisp-interaction-mode-hook
               'lisp-mode-hook
               'maxima-mode-hook
               'ielm-mode-hook
               'sh-mode-hook
               'makefile-gmake-mode-hook
               'php-mode-hook
               'python-mode-hook
               'js-mode-hook
               'go-mode-hook
               'qml-mode-hook
               'jade-mode-hook
               'css-mode-hook
               'ruby-mode-hook
               'coffee-mode-hook
               'rust-mode-hook
               'qmake-mode-hook
               'lua-mode-hook
               'swift-mode-hook
               'minibuffer-inactive-mode-hook
               ))
  (add-hook hook '(lambda () (awesome-pair-mode 1))))

(define-key awesome-pair-mode-map (kbd "(") 'awesome-pair-open-round)
(define-key awesome-pair-mode-map (kbd "[") 'awesome-pair-open-bracket)
(define-key awesome-pair-mode-map (kbd "{") 'awesome-pair-open-curly)
(define-key awesome-pair-mode-map (kbd ")") 'awesome-pair-close-round)
(define-key awesome-pair-mode-map (kbd "]") 'awesome-pair-close-bracket)
(define-key awesome-pair-mode-map (kbd "}") 'awesome-pair-close-curly)
(define-key awesome-pair-mode-map (kbd "%") 'awesome-pair-match-paren)
(define-key awesome-pair-mode-map (kbd "\"") 'awesome-pair-double-quote)
(define-key awesome-pair-mode-map (kbd "M-o") 'awesome-pair-backward-delete)
(define-key awesome-pair-mode-map (kbd "C-k") 'awesome-pair-kill)
(define-key awesome-pair-mode-map (kbd "M-\"") 'awesome-pair-wrap-double-quote)
(define-key awesome-pair-mode-map (kbd "M-[") 'awesome-pair-wrap-bracket)
(define-key awesome-pair-mode-map (kbd "M-{") 'awesome-pair-wrap-curly)
(define-key awesome-pair-mode-map (kbd "M-(") 'awesome-pair-wrap-round)
(define-key awesome-pair-mode-map (kbd "M-)") 'awesome-pair-unwrap)
(define-key awesome-pair-mode-map (kbd "M-p") 'awesome-pair-jump-right)
(define-key awesome-pair-mode-map (kbd "M-n") 'awesome-pair-jump-left)
(define-key awesome-pair-mode-map (kbd "M-:") 'awesome-pair-jump-out-pair-and-newline)
#+end_src
** ğŸ¬ TODO COMMENT maple-edit
ä¸çŸ¥é“æœ‰å•¥ç”¨
#+begin_src emacs-lisp
(use-package maple-iedit
  :ensure nil
  :commands (maple-iedit-match-all maple-iedit-match-next maple-iedit-match-previous)
  :config
  (setq maple-iedit-ignore-case t)

  (defhydra maple/iedit ()
    ("n" maple-iedit-match-next "next")
    ("t" maple-iedit-skip-and-match-next "skip and next")
    ("T" maple-iedit-skip-and-match-previous "skip and previous")
    ("p" maple-iedit-match-previous "prev"))
  :bind (:map evil-visual-state-map
              ("n" . maple/iedit/body)
              ("C-n" . maple-iedit-match-next)
              ("C-p" . maple-iedit-match-previous)
              ("C-t" . maple-iedit-skip-and-match-next)))
#+end_src
** evil-visual-replace
#+begin_src emacs-lisp
(use-package! evil-visual-replace
  :init
  (evil-visual-replace-visual-bindings))
#+end_src

** ğŸ¬ TODO Smartparens
   ä¿®æ”¹æˆ leader é”®
#+begin_src emacs-lisp
;; smartparens
(use-package smartparens
  :init
  (map! :map smartparens-mode-map
        "C-M-f" #'sp-forward-sexp
        "C-M-b" #'sp-backward-sexp
        "C-M-u" #'sp-backward-up-sexp
        "C-M-d" #'sp-down-sexp
        "C-M-p" #'sp-backward-down-sexp
        "C-M-n" #'sp-up-sexp
        "C-M-s" #'sp-splice-sexp
        "C-)" #'sp-forward-slurp-sexp
        "C-}" #'sp-forward-barf-sexp
        "C-(" #'sp-backward-slurp-sexp
        "C-M-)" #'sp-backward-slurp-sexp
        "C-M-)" #'sp-backward-barf-sexp))
#+end_src

** ğŸ¬ TODO COMMENT Poporg
   å°†æ–‡ç« é‡Œé¢çš„æ³¨é‡Š, ç”¨ org-mode çš„å½¢å¼æ¥ä¿®æ”¹.
#+begin_src emacs-lisp
(use-package poporg
  :bind (("C-c '" . poporg-dwim)))
#+end_src

|--------+-------------+------------|
| å¿«æ·é”® | å‘½ä»¤        | æè¿°       |
|--------+-------------+------------|
| C-c '  | poporg-dwim | å¼€å¯ poporg |
|--------+-------------+------------|

** ğŸ¬ TODO Hl-todo
#+begin_src emacs-lisp
;; hl-todo-mode
(use-package hl-todo
  :init
  (setq hl-todo-keyword-faces
        '(("TODO"    . 'hl-todo-TODO)
          ("ADDCONT" . 'hl-todo-ADDCONT)
          ("REF"     . 'hl-todo-REF)
          ("MODCONT" . 'hl-todo-MODCONT)
          ("FIXME"   . 'hl-todo-FIXME)
          ("XXX"     . 'hl-todo-XXX)
          ("DONE"    . 'hl-todo-DONE)))
  (defface hl-todo-TODO    '((t :background "#00FF00"  :foreground "#FF0000" :inherit (hl-todo)))
    "Face for highlighting the HOLD keyword.")
  (defface hl-todo-ADDCONT '((t :background "#00FF00"  :foreground "#FF0000" :inherit (hl-todo)))
    "Face for highlighting the HOLD keyword.")
  (defface hl-todo-REF      '((t :background "#00FF00" :foreground "#ff0000" :inherit (hl-todo)))
    "Face for highlighting the HOLD keyword.")
  (defface hl-todo-FIXME   '((t :background "#0000FF"  :foreground "#FF0000" :inherit (hl-todo)))
    "Face for highlighting the HOLD keyword.")
  (defface hl-todo-MODCONT  '((t :background "#0000FF" :foreground "#FF0000" :inherit (hl-todo)))
    "Face for highlighting the HOLD keyword.")
  (defface hl-todo-XXX      '((t :background "#000000" :foreground "#FFFFFF" :inherit (hl-todo)))
    "Face for highlighting the HOLD keyword.")
  (defface hl-todo-DONE    '((t :background "#00FF00"  :foreground "#00FF00" :inherit (hl-todo)))
    "Face for highlighting the HOLD keyword.")
  (map! :leader
        :prefix "c"
        :desc "show comment tags" "g" #'hl-todo-mode))
#+end_src

|---------+--------------|
| keyword |              |
|---------+--------------|
| TODO    | TODO         |
| ADDCONT | å¢åŠ è¡¨è¿°     |
| REF     | ä¿®æ”¹å¼•ç”¨ææ–™ |
| FIXME   | ä¿®æ”¹æœ¬æ®µä»£ç  |
| MODCONT | ä¿®æ”¹æœ¬æ®µè¡¨è¿° |
| XXX     | æ ‡æ˜æ€ªäº‹     |
| DONE    | å®Œæˆ         |
|---------+--------------|


|-----------+--------------+----------------|
| å¿«æ·é”®    | å‘½ä»¤         | æè¿°           |
|-----------+--------------+----------------|
| =SPC c g= | hl-todo-mode | å¼€å¯ todo ç‰¹å¾ |
|-----------+--------------+----------------|


#+begin_src emacs-lisp
(map! :leader
      :desc "ivy magit todo"             "g i" #'ivy-magit-todos)
#+end_src

|------------+-----------------+----------------|
| å¿«æ·é”®     | å‘½ä»¤            | æè¿°           |
|------------+-----------------+----------------|
| =SPC g i = | ivy-magit-todos | å±•ç¤ºæ¯ä¸ªå…³é”®è¯ |
|------------+-----------------+----------------|
** â˜¯ DONE Yasnippet
ä¸€äº›å¿«é€Ÿè¾“å…¥æ¨¡æ¿
#+begin_src emacs-lisp
(use-package yasnippet
  :config
  (add-to-list 'yas-snippet-dirs "~/.doom.d/snippets"))
#+end_src

#+begin_src emacs-lisp
(use-package yasnippet-snippets)
#+end_src

#+begin_src emacs-lisp
(use-package ivy-yasnippet)
#+end_src
** â˜¯ DONE Hungry delete
å¿«é€Ÿåˆ é™¤å¤ªå¤šçš„ç©ºæ ¼/åˆ¶è¡¨ç¬¦
#+begin_src emacs-lisp
(use-package hungry-delete
  :config
  (add-hook 'after-init-hook #'global-hungry-delete-mode))
#+end_src

** â˜¯ DONE Company-poseframe
ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨, æ‹¿æ¥åšcompanyçš„æ˜¾ç¤º?
#+begin_src emacs-lisp
(use-package company-posframe
  :hook (company-mode . company-posframe-mode))
#+end_src

** â˜¯ DONE So-long
æŠŠå¤ªé•¿çš„è¡Œç”¨ ... æ¥æ˜¾ç¤º
#+begin_src emacs-lisp
(use-package so-long
  :config (global-so-long-mode 1))
#+end_src
** â˜¯ DONE Hide-show-mode
æ˜¾ç¤º-éšè— code blocks
#+begin_src emacs-lisp
(map! :leader
      (:prefix-map  ("e" . "edit")
       (:prefix-map ("h" . "hide code")
        :desc "hide block"               "b" #'hs-hide-block
        :desc "hide level"               "l" #'hs-hide-level
        :desc "hide all"                 "a" #'hs-hide-all)
       (:prefix-map ("s" . "show code")
        :desc "show block"               "b" #'hs-show-block
        :desc "show level"               "l" #'hs-show-level
        :desc "show all"                 "a" #'hs-show-all )))
#+end_src

#+RESULTS:
: hs-show-all

** ğŸ¬ TODO COMMENT Whitespace
ä¸çŸ¥é“æ˜¯å•¥
#+begin_src emacs-lisp
(use-package whitespace
  :hook ((prog-mode markdown-mode conf-mode latex-mode ) . whitespace-mode)
  :config
  (setq whitespace-style '(face trailing)))
#+end_src

** ğŸ¬ TODO COMMENT Autorevert
ä¸çŸ¥é“æ˜¯å•¥
#+begin_src emacs-lisp
(use-package autorevert
  :hook (after-init . global-auto-revert-mode))
#+end_src
** â˜¯ DONE Commentaries
ç”¨æ¥å¿«é€Ÿæ³¨é‡Šæ–‡æœ¬
#+begin_src emacs-lisp
(global-set-key (kbd "C-c C-\\") (quote comment-line))
#+end_src
** ğŸ¬ TODO COMMENT White-room
ä¸çŸ¥é“æ˜¯å•¥
#+begin_src emacs-lisp
(use-package writeroom-mode
  :hook
  (w3m-mode . writeroom-mode)
  :config
  (advice-add 'text-scale-adjust :after
              #'visual-fill-column-adjust)
  ;;https://github.com/joostkremers/writeroom-mode#fullscreen-effect
  (setq writeroom-fullscreen-effect 'maximized))
#+end_src
** â˜¯ DONE grugru
ä¸€ä¸ªæœ‰è¶£çš„æ–‡æœ¬æ›´æ¢å™¨ [[https://github.com/ROCKTAKEY/grugru][ROCKTAKEY/grugru]]
#+begin_src emacs-lisp
(use-package grugru
  :config (grugru-default-setup))
#+end_src

#+RESULTS:
** ğŸ¬ TODO undo-fu
è¿˜ä¸ä¼šç”¨çš„, ç±»ä¼¼undo-treeçš„ä¸œè¥¿, è€Œä¸”æœ‰ç‚¹å¤æ‚...
#+begin_src emacs-lisp
(use-package undo-fu
  :after-call doom-switch-buffer after-find-file
  :init
  (after! undo-tree
    (global-undo-tree-mode -1))
  :config
  ;; Store more undo history to prevent loss of data
  (setq undo-limit 400000
        undo-strong-limit 3000000
        undo-outer-limit 3000000)

  (define-minor-mode undo-fu-mode
    "Enables `undo-fu' for the current session."
    :keymap (let ((map (make-sparse-keymap)))
              (define-key map [remap undo] #'undo-fu-only-undo)
              (define-key map [remap redo] #'undo-fu-only-redo)
              (define-key map (kbd "C-_")     #'undo-fu-only-undo)
              (define-key map (kbd "M-_")     #'undo-fu-only-redo)
              (define-key map (kbd "C-M-_")   #'undo-fu-only-redo-all)
              (define-key map (kbd "C-x r u") #'undo-fu-session-save)
              (define-key map (kbd "C-x r U") #'undo-fu-session-recover)
              map)
    :init-value nil
    :global t)
  (undo-fu-mode +1))

(map! :leader
      (:prefix "e"
       :desc "undo-fu-only-undo"          "u"      #'undo-fu-only-undo
       :desc "undo-fu-only-redo"          "r"      #'undo-fu-only-redo
       :desc "undo-fu-only-redo-allow"    "a"      #'undo-fu-only-redo-all
       :desc "undo-fu-session-save"       "e"      #'undo-fu-session-save
       :desc "undo-fu-session-recover"    "d"      #'undo-fu-session-recover ))

(use-package undo-fu-session
  :hook (undo-fu-mode . global-undo-fu-session-mode)
  :preface
  (setq undo-fu-session-directory (concat doom-cache-dir "undo-fu-session/")
        undo-fu-session-incompatible-files '("/COMMIT_EDITMSG\\'" "/git-rebase-todo\\'"))

  ;; HACK We avoid `:config' here because `use-package's `:after' complicates
  ;;      the load order of a package's `:config' block and makes it impossible
  ;;      for the user to override its settings with merely `after!' (or
  ;;      `eval-after-load'). See jwiegley/use-package#829.
  (after! undo-fu-session
    ;; HACK Use the faster zstd to compress undo files instead of gzip
    (when (executable-find "zstd")
      (defadvice! doom--undo-fu-session-use-zstd-a (filename)
        :filter-return #'undo-fu-session--make-file-name
        (if undo-fu-session-compression
            (concat (file-name-sans-extension filename) ".zst")
          filename)))))
#+end_src
** â˜¯ DONE which-key
å±•ç¤ºä½¿ç”¨çš„ key-bindings
#+begin_src emacs-lisp
(use-package which-key
  :init
  (which-key-mode))
#+end_src

* ğŸ¬ TODO org-mode faces and operations
:PROPERTIES:
:ID:       c657f8f4-abbc-4d83-8198-822910968303
:END:
** â˜¯ DONE heading-level-face
#+begin_src emacs-lisp
(custom-set-faces
 '(org-level-1 ((t (:inherit outline-1 :height 1.3))))
 '(org-level-2 ((t (:inherit outline-2 :height 1.2))))
 '(org-level-3 ((t (:inherit outline-3 :height 1.1)))))
#+end_src
** â˜¯ DONE org-super-star

#+begin_src emacs-lisp
(use-package org-superstar
  :config
  (add-hook 'org-mode-hook (lambda () (org-superstar-mode 1)))
  (setq org-superstar-headline-bullets-list '("â˜°" "â˜·" "â˜µ" "â˜²"  "â˜³" "â˜´"  "â˜¶"  "â˜±" )))
#+end_src

** â˜¯ DONE ellipsis at the end of heading

#+begin_src emacs-lisp
(setq org-ellipsis " Â·Â·Â· ")
#+end_src
** â˜¯ DONE bold/delete/emph
#+begin_src emacs-lisp
(setq org-hide-emphasis-markers t)
#+end_src
** ğŸ¬ TODO COMMENT valign formate
#+begin_src emacs-lisp
(use-package valign
  :init
  (require 'valign)
  :hook
  ('org-mode . #'valign-mode))
#+end_src
** â˜¯ DONE org-heading and item
ç”¨æ¥æ›´æ”¹headingåˆ°æ ‡é¢˜
#+begin_src emacs-lisp
(map! :leader
      (:prefix "m"
       (:prefix-map ("m" . "modify")
        :desc "item or text"             "i" #'org-toggle-item
        :desc "heading or text"          "h" #'org-toggle-heading )))
#+end_src

** â˜¯ DONE evil org-mode
ä¿è¯evil-mode å¯ä»¥ç”¨åœ¨org-modeé‡Œé¢

#+begin_src emacs-lisp
(after! org
  (add-hook 'org-mode-hook (lambda () (evil-org-mode 1))))
#+end_src

** â˜¯ DONE org-download
Shamelessly copy [[https://github.com/jethrokuan/dots/edit/master/.doom.d/config.el][jethrokuan/dots/doom.d/config.el]]
#+begin_src emacs-lisp :tangle yes
(use-package! org-download
  :commands
  org-download-dnd
  org-download-yank
  org-download-screenshot
  org-download-dnd-base64
  :init
  (map! :map org-mode-map
        "s-Y" #'org-download-screenshot
        "s-y" #'org-download-yank)
  (pushnew! dnd-protocol-alist
            '("^\\(?:https?\\|ftp\\|file\\|nfs\\):" . org-download-dnd)
            '("^data:" . org-download-dnd-base64))
  (advice-add #'org-download-enable :override #'ignore)
  :config
  (defun +org/org-download-method (link)
    (let* ((filename
            (file-name-nondirectory
             (car (url-path-and-query
                   (url-generic-parse-url link)))))
           ;; Create folder name with current buffer name, and place in root dir
           (dirname (concat "./images/"
                            (replace-regexp-in-string " " "_"
                                                      (downcase (file-name-base buffer-file-name))))))
      (make-directory dirname t)
      (expand-file-name filename dirname)))
  :config
  (setq org-download-screenshot-method
        (cond (IS-MAC "screencapture -i %s")
              (IS-LINUX
               (cond ((executable-find "maim")  "maim -u -s %s")
                     ((executable-find "scrot") "scrot -s %s")))))
  (setq org-download-method '+org/org-download-method))
#+end_src

* ğŸ¬ TODO org-mode and workflow
:PROPERTIES:
:ID:       63085241-dd26-4300-9f13-1ad3ae3bfe18
:END:
** ğŸ¬ TODO files
jump o inbox/next quicker
#+begin_src emacs-lisp
(defun py/jump-to-inbox ()
  (interactive)
  (find-file py/inbox))
#+end_src

#+begin_src emacs-lisp
(defun py/jump-to-next()
  (interactive)
  (find-file py/next))
#+end_src

#+begin_src emacs-lisp
(map! :leader
      :desc "jump to inbox"             "n i" #'py/jump-to-inbox
      :desc "jump to next"              "n N" #'py/jump-to-next)
#+end_src

#+RESULTS:
: py/jump-to-inbox

** task managerment
Still wanna to use a collect and conquer (C&C) method to manage my tasks.
*Capture* my random idea into the =inbox.org= file;
*Refile* the captured idea to =project= =next.org= =things= =arts= =braindump= files or directories.
*** ğŸ¬ TODO capture
:PROPERTIES:
:ID:       feb39079-1ca8-4f92-8809-9cc77574a64b
:END:
keymap

#+begin_src emacs-lisp
(after! org
  (map! :leader :desc "org-capture"           "x" #'org-capture))
#+end_src

doct
#+begin_src emacs-lisp
(use-package doct
  :ensure t
  ;;recommended: defer until calling doct
  :commands (doct))
#+end_src

#+begin_src emacs-lisp
(setq org-capture-templates
      (doct '(
              ;;Standard inbox inbox
              ("Inbox"
               :keys "i"
               :file py/inbox
               :template ("* %{todo-state} %?"
                          ":PROPERTIES:"
                          ":INIT:       %U"
                          ":END:")
               :todo-state "ğŸ¬ TODO"
               :create-id t)
              ;;Metacognition
              ("Metacog"
               :keys "m"
               :prepend t
               :template ("* %{todo-state} %?"
                          ":PROPERTIES:"
                          ":INIT:       %U"
                          ":END:")
               :children (("MetaNotes"
                           :keys "n"
                           :type entry
                           :todo-state "ğŸ¬ TODO"
                           :function (lambda () (jethro/olp-current-buffer "Metacog" "Notes")))
                          ("MetaQuestions"
                           :keys "q"
                           :type entry
                           :todo-state "ğŸ¬ TODO"
                           :function (lambda () (jethro/olp-current-buffer "Metacog" "Questions")))
                          ("MetaTodos"
                           :keys "t"
                           :type entry
                           :todo-state "ğŸ¬ TODO"
                           :function (lambda () (jethro/olp-current-buffer "Metacog" "Todos")))))
              ("Bipolar"
               :keys "b"
               :prepend t
               :children (("æœè¯æƒ…å†µ"
                           :keys "1"
                           :type table-line
                           :file py/bipolar
                           :headline "æœè¯æƒ…å†µ"
                           :table-line-pos "I-1"
                           :template ("| %t | %^{ç¢³é…¸é”‚æ­£å¸¸æœç”¨?} | %^{æ‹‰è«ä¸‰å—ªæ­£å¸¸æœç”¨?} | %^{ç›é…¸æ™®æ‹‰å…‹ç´¢æ­£å¸¸æœç”¨?} | %^{å”‘å¡å¦æ­£å¸¸æœç”¨ï¼Ÿ} |"))
                          ("ç¡çœ æƒ…å†µ"
                           :keys "2"
                           :type table-line
                           :file py/bipolar
                           :headline "ç¡çœ æƒ…å†µ"
                           :table-line-pos "I-1"
                           :template ("| %t | %^{æ™šä¸Šç¡äº†å¤šä¹…?} | %^{ä¸­åˆç¡äº†å¤šä¹…?} |"))
                          ("æ€¥èº&ç„¦è™‘æƒ…å†µ"
                           :keys "3"
                           :type table-line
                           :file py/bipolar
                           :headline "æ€¥èº&ç„¦è™‘æƒ…å†µ"
                           :table-line-pos "I-1"
                           :template ("| %t | %^{å¤‡æ³¨} | %^{æ€¥èºç­‰çº§ (1-10)} | %^{æ€¥èºå†…å®¹} | %^{ç„¦è™‘ç­‰çº§} | %^{ç„¦è™‘å†…å®¹} |"))
                          ("å·¥ä½œå†…å®¹è®°å½•"
                           :keys "4"
                           :type table-line
                           :file py/bipolar
                           :headline "å·¥ä½œå†…å®¹è®°å½•"
                           :table-line-pos "I-1"
                           :template ("| %t | %^{å·¥ä½œå†…å®¹1} | %^{æ—¶é•¿} | %^{å·¥ä½œå†…å®¹2} | %^{æ—¶é•¿} | %^{å·¥ä½œå†…å®¹3} | %^{æ—¶é•¿} | %^{å·¥ä½œå†…å®¹4} | %^{æ—¶é•¿} | "))
                          ("æŠ‘éƒ&èºç‹‚è®°å½•"
                           :keys "5"
                           :type table-line
                           :file py/bipolar
                           :headline "æŠ‘éƒ&èºç‹‚è®°å½•"
                           :table-line-pos "I-1"
                           :template ("| %t | %^{æŠ‘éƒç¨‹åº¦} | %^{èºç‹‚ç¨‹åº¦} |"))
                          ("ç²¾ç¥çŠ¶æ€&å¹»è§‰&æ€ªè¯æƒ³æ³•è®°å½•"
                           :keys "6"
                           :type table-line
                           :file py/bipolar
                           :headline "ç²¾ç¥çŠ¶æ€ å¹»è§‰ æ€ªè¯æƒ³æ³•è®°å½•"
                           :table-line-pos "I-1"
                           :template ("| %t | %^{ç²¾ç¥çŠ¶æ€(éšä¾¿è¯´è¯´)} | %^{å¹»è§‰?} | %^{æ€ªè¯æƒ³æ³•} |"))
                          ("å¿«ä¹äº‹ä»¶è®°å½•"
                           :keys "7"
                           :type table-line
                           :file py/bipolar
                           :headline "å¿«ä¹äº‹ä»¶è®°å½•"
                           :table-line-pos "I-1"
                           :template ("| %t | %^{å†…å®¹1} | %^{å†…å®¹2} | %^{å†…å®¹3} |")))))))
#+end_src

Shameless copied functions
#+begin_src emacs-lisp
(defun jethro/find-or-create-olp (path &optional this-buffer)
  "Return a marker pointing to the entry at outline path OLP.
If anything goes wrong, throw an error, and if you need to do
something based on this error, you can catch it with
`condition-case'.
If THIS-BUFFER is set, the outline path does not contain a file,
only headings."
  (let* ((file (pop path))
         (level 1)
         (lmin 1)
         (lmax 1)
         (start (point-min))
         (end (point-max))
         found flevel)
    (unless (derived-mode-p 'org-mode)
      (error "Buffer %s needs to be in Org mode" buffer))
    (org-with-wide-buffer
     (goto-char start)
     (dolist (heading path)
       (let ((re (format org-complex-heading-regexp-format
                         (regexp-quote heading)))
             (cnt 0))
         (while (re-search-forward re end t)
           (setq level (- (match-end 1) (match-beginning 1)))
           (when (and (>= level lmin) (<= level lmax))
             (setq found (match-beginning 0) flevel level cnt (1+ cnt))))
         (when (> cnt 1)
           (error "Heading not unique on level %d: %s" lmax heading))
         (when (= cnt 0)
           ;; Create heading if it doesn't exist
           (goto-char end)
           (unless (bolp) (newline))
           (org-insert-heading nil nil t)
           (unless (= lmax 1) (org-do-demote))
           (insert heading)
           (setq end (point))
           (goto-char start)
           (while (re-search-forward re end t)
             (setq level (- (match-end 1) (match-beginning 1)))
             (when (and (>= level lmin) (<= level lmax))
               (setq found (match-beginning 0) flevel level cnt (1+ cnt))))))
       (goto-char found)
       (setq lmin (1+ flevel) lmax (+ lmin (if org-odd-levels-only 1 0)))
       (setq start found
             end (save-excursion (org-end-of-subtree t t))))
     (point-marker))))

(defun jethro/olp-current-buffer (&rest outline-path)
  "Find the OUTLINE-PATH of the current buffer."
  (let ((m (jethro/find-or-create-olp (cons (buffer-file-name) outline-path))))
    (set-buffer (marker-buffer m))
    (org-capture-put-target-region-and-position)
    (widen)
    (goto-char m)
    (set-marker m nil)))

#+end_src
*** ğŸ¬ TODO refile
:PROPERTIES:
:ID:       dd1f4fcc-c04c-45c1-bc6c-7550ff84bba0
:END:
Inspried by [[https://emacs.stackexchange.com/questions/24976/org-mode-can-you-set-up-context-dependent-refile-targets][context-dependent org-refile]] I should imporve refile process.
**** initial
#+begin_src emacs-lisp
(setq org-refile-targets nil)
#+end_src

#+RESULTS:

**** internal
#+begin_src emacs-lisp
(add-to-list 'org-refile-targets '(nil :maxlevel . 9))
#+end_src

**** one-off
#+begin_src emacs-lisp
(add-to-list 'org-refile-targets '(py/next :maxlevel . 1))
#+end_src

**** arts
#+begin_src emacs-lisp
(add-to-list 'org-refile-targets '(py/arts :maxlevel . 1))
#+end_src
**** braindump
#+begin_src emacs-lisp
(add-to-list 'org-refile-targets '(py/braindump-inbox :maxlevel . 1))
#+end_src
**** project
#+begin_src emacs-lisp
(setq py/project-files
      (directory-files-recursively py/project-dir (rx ".org" eos)))
#+end_src

#+RESULTS:
| ~/Dropbox/.org/things/project/chemotaxis.org |

#+begin_src emacs-lisp
(add-to-list 'org-refile-targets '(py/project-files :maxlevel . 1))
#+end_src

**** thoughts
#+begin_src emacs-lisp
(add-to-list 'org-refile-targets '(py/thoughts :maxlevel . 1))
#+end_src

**** arts
#+begin_src emacs-lisp
(add-to-list 'org-refile-targets '(py/arts :maxlevel . 1))
#+end_src
** ğŸ¬ TODO in-file structures
*** todo keyword
#+begin_src emacs-lisp
(setq org-todo-keywords
        '((sequence
           "ğŸ¬ TODO(t)"  ; A task that needs doing & is ready to do
           "ğŸ—¡ INPROCESS(s)"  ; A task that is in progress
           "ğŸ“Œ WAITING(w)"  ; Something is holding up this task; or it is paused
           "â° LEAVETO(l)"  ; entry delivered to others
           "â¤´ REFILE?(r)"   ;might
           "|"
           "ğŸ’¡ NEXT(n)"
           "â˜¯ DONE(d)"  ; Task successfully completed
           "CANCELED(c@)") ; Task was cancelled, aborted or is no longer applicable
           )) ; Task was completed
#+end_src

*** todo keyword faces
:PROPERTIES:
:ID:       e5b8a7ba-e9f6-4f3f-99d7-1bdd289b1ae2
:INIT:     [2021-01-12 Tue 08:04]
:END:
#+begin_src emacs-lisp
(setq org-todo-keyword-faces
      (quote (("ğŸ¬ TODO" :foreground "red" :weight bold)
              ("ğŸ—¡ INPROCESS" :foreground "forest green" :weight bold)
              ("ğŸ“Œ WAITING" :foreground "orange" :weight bold)
              ("â° LEAVETO" :foreground "forest green" :weight bold)
              ("â¤´ REFILE" :foreground "magenta" :weight bold)
              ("ğŸ’¡ NEXT" :foreground "blue" :weight bold)
              ("â˜¯ DONE" :foreground "forest green" :weight bold)
              ("CANCELLED" :foreground "forest green" :weight bold)
              )))
#+end_src

#+RESULTS:
| ğŸ¬ TODO     | :foreground | red          | :weight | bold |
| ğŸ—¡ INPROCESS | :foreground | forest green | :weight | bold |
| ğŸ“Œ WAITING  | :foreground | orange       | :weight | bold |
| â° LEAVETO  | :foreground | forest green | :weight | bold |
| â¤´ REFILE    | :foreground | magenta      | :weight | bold |
| ğŸ’¡ NEXT     | :foreground | blue         | :weight | bold |
| â˜¯ DONE      | :foreground | forest green | :weight | bold |
| CANCELLED   | :foreground | forest green | :weight | bold |


#+caption:
| ğŸ¬ TODO     | :foreground | red          | :weight | bold |
| ğŸ—¡ INPROCESS | :foreground | forest green | :weight | bold |
| ğŸ“Œ WAITING  | :foreground | orange       | :weight | bold |
| â° LEAVETO  | :foreground | forest green | :weight | bold |
| â¤´ REFILE    | :foreground | magenta      | :weight | bold |
| ğŸ’¡ NEXT     | :foreground | blue         | :weight | bold |
| â˜¯ DONE      | :foreground | forest green | :weight | bold |
| CANCELLED   | :foreground | forest green | :weight | bold |

*** tags
keymap: =Spc m q= org-set-tag-command
#+begin_src emacs-lisp
(setq org-tag-alist
      '(("@errand" . ?e)
        ("@office" . ?o)
        ("@home" . ?h)))
#+end_src

*** properties
**** id
modify-id operation
notes-id operations
#+begin_src emacs-lisp
(map! :leader
      :prefix "n"
      (:prefix-map              ("I" . "id")
       :desc "id-goto"          "g" #'org-id-goto
       :desc "id-copy"          "c" #'org-id-copy))
#+end_src

**** initial-time
***** captgure: use the templates
***** normal:
:PROPERTIES:
:ID:       e37fa0af-d194-471d-9f67-1803f1e6be44
:INIT:     [2021-01-11 Mon 23:35]
:LOCATION: dod
:END:

keymaps:
#+begin_src emacs-lisp
(map! :leader
      :desc "set initial property" "mdi" #'org-set-property-initial-time
      :desc "set initial property" "mcs" #'org-set-property-initial-time)
#+end_src

****** works
:PROPERTIES:
:LOCATION: dod
:END:
Time formate
#+begin_src emacs-lisp
(defvar org-initial-current-time-format "[%Y-%m-%d %a %H:%M]"
  "Format of date to insert with `insert-current-date-time' func
See help of `format-time-string' for possible replacements")
#+end_src

#+RESULTS:
: org-initial-current-time-format

#+begin_src emacs-lisp
(defun org-set-property-initial-time ()
  "Set the initial time property of entries in orgmode as\n
:INIT:    [YEAR-MONTH-DAY WEEKDAY HOUR:MIN]\n
when you realize it IS initalized."
  (interactive)
  (if (member "INIT" (org-entry-properties nil 'standard))
      ()
   (org-set-property "INIT" (format-time-string org-initial-current-time-format (current-time)))
    ))
#+end_src

#+RESULTS:
: org-set-property-initial-time

**** schedual/deadline
org-schedual
org-deadline
**** effort
:LOGBOOK:
CLOCK: [2021-01-11 Mon 07:13]--[2021-01-11 Mon 07:14] =>  0:01
:END:
org-set-effort

#+begin_src emacs-lisp
(map! :leader
      (:prefix "m"
       (:prefix "c"
        :desc "set effort"    "e"     #'org-set-effort)))
#+end_src

#+begin_src emacs-lisp
(add-to-list 'org-global-properties
      '("Effort_ALL". "0:05 0:15 0:30 1:00 1:30 2:00 3:00 4:00"))
#+end_src

**** clock-sum
:LOGBOOK:
CLOCK: [2021-01-11 Mon 07:14]--[2021-01-11 Mon 07:14] =>  0:00
:END:
clock-in
clock-in-last-clock
clock-out
clock-time-report
**** pomodoro
use the basic org-pomodoro
** ğŸ¬ TODO knowledge managerment
*** COMMENT notdeft -- file manager
:PROPERTIES:
:ID:       17320e65-cf37-4bfa-91ec-fea2af3308af
:END:
#+begin_src emacs-lisp
(use-package notdeft
  :config
  (setq notdeft-extension "org")
  (setq notdeft-directories '("~/Dropbox/.org/"))
  (setq notdeft-xapian-program "/home/py06/.local/share/notdeft-xapian")
  (map! :leader
        (:prefix "d"
         :desc   "notdeft"      "d" #'notdeft ))
  :bind (:map notdeft-mode-map
         ("C-q" . notdeft-quit)
         ("C-r" . notdeft-refresh)))
#+end_src

#+begin_src emacs-lisp
(setenv "XAPIAN_CJK_NGRAM" "1")
#+end_src

#+begin_src emacs-lisp
(map! :leader
      (:prefix "n"
       :desc "notdeft" "n" #'notdeft ))
#+end_src

#+RESULTS:
: notdeft
*** org-roam -- knowledge base
**** directories, files and other basic settings
#+begin_src emacs-lisp
(use-package org-roam
  :commands (org-roam-insert org-roam-find-file org-roam-switch-to-buffer org-roam)
  :hook
  (after-init . org-roam-mode))
#+end_src

#+begin_src emacs-lisp
(setq   org-roam-directory              py/braindump-dir
        org-roam-index-file             py/braindump-index
        org-roam-dailies-directory      "dailies/"
        org-roam-db-gc-threshold        most-positive-fixnum
        org-roam-graph-exclude-matcher  "private"
        org-roam-tag-sources            '(prop last-directory)
        org-id-link-to-org-use-id t)
#+end_src
**** keymaps
#+begin_src emacs-lisp
(map! :leader
      (:prefix ("r" . "roam")
       :desc "Switch to buffer"              "b" #'org-roam-switch-to-buffer
       (:prefix ("d" . "by date")
        :desc "Arbitrary date" "d" #'org-roam-dailies-find-date
        :desc "Today"          "t" #'org-roam-dailies-find-today
        :desc "Tomorrow"       "m" #'org-roam-dailies-find-tomorrow
       :desc "Yesterday"       "y" #'org-roam-dailies-find-yesterday)
       :desc "Find file"                     "f" #'org-roam-find-file
       :desc "Show graph"                    "g" #'org-roam-graph
       :desc "Insert new text"               "i" #'org-roam-insert
       :desc "Insert selected text"          "I" #'org-roam-insert-immediate
       :desc "Jump to index"                 "j" #'org-roam-jump-to-index
       :desc "Roam buffer"                   "r" #'org-roam
       :desc "Org Roam Capture"              "x" #'org-roam-capture))
#+end_src

#+RESULTS:
: org-roam-capture

**** roam-capture
:PROPERTIES:
:ID:       9bc394e5-f10a-4e4a-8363-79389f81156a
:END:
***** roam-protocol
:PROPERTIES:
:ID:       423d963d-3149-4cb9-8386-ec2e61e16454
:END:
#+begin_src emacs-lisp
(use-package org-roam-protocol
  :after org-protocol)
#+end_src

***** roam-cpature template
#+begin_src emacs-lisp
(setq org-roam-capture-templates
             ;; literally
      '(("d" "default" plain (function org-roam--capture-get-point)
           "%?"
           :file-name "${slug}"
           :head "#+title: ${title}\n"
           :unnarrowed t)))
;; org-roam-capture-immediate
(setq org-roam-capture-immediate-template
             ;; default
             '("d" "default" plain (function org-roam--capture-get-point)
               "%?"
               :file-name "${slug}"
               :head "#+title: ${title}\n"
               :unnarrowed t))
#+end_src
***** roam-capture-ref-templates
#+begin_src emacs-lisp
(setq org-roam-capture-ref-templates nil)
(add-to-list 'org-roam-capture-ref-templates
             '("r" "ref" plain (function org-roam-capture--get-point)
               ""
               :file-name "${slug}"
               :head "#+title: ${title}\n#+roam_key: ${ref}\n"
               :unnarrowed t))
(add-to-list 'org-roam-capture-ref-templates
             '("a" "Annotation" plain (function org-roam-capture--get-point)
               "%U \n${body}\n"
               :file-name "${slug}"
               :head "#+title: ${title}\n#+roam_key: ${ref}\n#+roam_alias:\n"
               :immediate-finish t
               :unnarrowed t))
#+end_src

#+RESULTS:
| a | Annotation | plain | #'org-roam-capture--get-point | %U |

**** roam-server
#+begin_src emacs-lisp
(use-package org-roam-server
  :config
  (setq org-roam-server-host "127.0.0.1"
        org-roam-server-port 9090
        org-roam-server-authenticate nil
        org-roam-server-export-inline-images t
        org-roam-server-serve-files nil
        org-roam-server-served-file-extensions '("pdf" "mp4" "ogv")
        org-roam-server-network-poll t
        org-roam-server-network-arrows nil
        org-roam-server-network-label-truncate t
        org-roam-server-network-label-truncate-length 60
        org-roam-server-network-label-wrap-length 20))
#+end_src

** ğŸ¬ TODO agenda customization
We discuss different agendas here
*** super-agenda
#+begin_src emacs-lisp
(use-package org-super-agenda
:config
(add-hook! 'after-init-hook 'org-super-agenda-mode)
(setq org-agenda-skip-scheduled-if-done t
      org-agenda-skip-deadline-if-done t
      org-agenda-include-deadlines t
      org-agenda-include-diary nil
      org-agenda-block-separator nil
      org-agenda-compact-blocks t
      org-agenda-start-with-log-mode t)
(setq org-columns-default-format
      "%40ITEM(Task) %Effort(EE){:} %CLOCKSUM(Time Spent) %SCHEDULED(Scheduled) %DEADLINE(Deadline)"))
#+end_src

*** agenda

#+begin_src emacs-lisp
(setq org-agenda-custom-commands
      `(("b" "BrainDump"
         ((todo "ğŸ¬ TODO|ğŸ—¡ INPROCESS"
                ((org-agenda-overriding-header "To Refile")
                 (org-agenda-files '(,(expand-file-name py/braindump-inbox)))))
          (todo "ğŸ¬ TODO|ğŸ—¡ INPROCESS"
                ((org-agenda-overriding-header "To Detail")
                 (org-agenda-files (directory-files-recursively py/braindump-dir (rx ".org" eos)))))
          (todo "ğŸ¬ TODO|ğŸ—¡ INPROCESS"
                ((org-agenda-overriding-header "Arts, To Refile")
                 (org-agenda-files '(,(expand-file-name py/arts)))))
          (todo "ğŸ¬ TODO|ğŸ—¡ INPROCESS"
                ((org-agenda-overriding-header "Arts, To Detail")
                 (org-agenda-files (directory-files-recursively py/arts-dir (rx ".org" eos)))))))
        ("p" "Pei's Agenda"
         ((alltodo "" ((org-agenda-overriding-header "To Refile")
                       (org-agenda-files '(,(expand-file-name py/inbox)))))
          (alltodo "" ((org-agenda-overriding-header "One-off-task" )
                       (org-agenda-files '(,(expand-file-name py/next )))))
          (agenda "" ((org-agenda-span 3)
                      (org-agenda-start-day "-1d")
                      (org-agenda-files (directory-files-recursively py/project-dir (rx ".org" eos)))
                      (org-super-agenda-groups
                       '((:name "Schedual"
                                :time-grid t
                                :date today
                                :scheduled today
                                :order 1)
                         (:name "Deadline"
                                :time-grid t
                                :date today
                                :deadline today
                                :order 2)))))
          ))))
#+end_src

** COMMENT pdf annotation
*** org-noter
#+begin_src emacs-lisp
(use-package org-noter
  :config
  ;; Your org-noter config ........
  (require 'org-noter-pdftools))
#+end_src
*** org-pdftools
#+begin_src emacs-lisp
(use-package org-pdftools
  :hook (org-mode . org-pdftools-setup-link))
#+end_src
*** org-noter-pdf-tools
**** code
#+begin_src emacs-lisp
(use-package org-noter-pdftools
  :after org-noter
  :config
  ;; Add a function to ensure precise note is inserted
  (defun org-noter-pdftools-insert-precise-note (&optional toggle-no-questions)
    (interactive "P")
    (org-noter--with-valid-session
     (let ((org-noter-insert-note-no-questions (if toggle-no-questions
                                                   (not org-noter-insert-note-no-questions)
                                                 org-noter-insert-note-no-questions))
           (org-pdftools-use-isearch-link t)
           (org-pdftools-use-freestyle-annot t))
       (org-noter-insert-note (org-noter--get-precise-info)))))

  ;; fix https://github.com/weirdNox/org-noter/pull/93/commits/f8349ae7575e599f375de1be6be2d0d5de4e6cbf
  (defun org-noter-set-start-location (&optional arg)
    "When opening a session with this document, go to the current location.
With a prefix ARG, remove start location."
    (interactive "P")
    (org-noter--with-valid-session
     (let ((inhibit-read-only t)
           (ast (org-noter--parse-root))
           (location (org-noter--doc-approx-location (when (called-interactively-p 'any) 'interactive))))
       (with-current-buffer (org-noter--session-notes-buffer session)
         (org-with-wide-buffer
          (goto-char (org-element-property :begin ast))
          (if arg
              (org-entry-delete nil org-noter-property-note-location)
            (org-entry-put nil org-noter-property-note-location
                           (org-noter--pretty-print-location location))))))))
  (with-eval-after-load 'pdf-annot
    (add-hook 'pdf-annot-activate-handler-functions #'org-noter-pdftools-jump-to-note)))
#+end_src
**** usage
- select a pdf file, use =org-noter= to open an related org-file
- use =org-ref-creat-skelonton= to import toc or outline
- use =org-noter-sync-*= to sync pdf-docview and org-mode
- use =org-noter-insert-note= to insert note while your org-noter-sync- is buffering
  + when the org-file is synced,

** COMMENT org-mode for bipolar log

*** è®¾ç½®
:PROPERTIES:
:ID:       d356b6cd-7ab7-4698-aec5-5d48ca257bf5
:END:

#+begin_src emacs-lisp
(add-to-list 'org-capture-templates '("b" "Bipolar"))
#+end_src

*** æœè¯æƒ…å†µ
:PROPERTIES:
:ID:       cc188716-00ee-4357-b38c-dd40f9e8cffa
:END:

| è®°å½•æ—¥æœŸ | ç¢³é…¸é”‚ | æ‹‰è«ä¸‰å—ª | ç›é…¸æ™®æ‹‰å…‹ç´¢ | é…’çŸ³é…¸å”‘å¡å¦ |

#+begin_src emacs-lisp
(add-to-list 'org-capture-templates
             '("b1"
               "æœè¯æƒ…å†µ"
               table-line
               (file+headline py/bipolar "æœè¯æƒ…å†µ")
               "| %t | %^{ç¢³é…¸é”‚æ­£å¸¸æœç”¨ï¼Ÿ} | %^{æ‹‰è«ä¸‰å—ªæ­£å¸¸æœç”¨ï¼Ÿ} | %^{ç›é…¸æ™®æ‹‰å…‹ç´¢æ­£å¸¸æœç”¨ï¼Ÿ} | %^{å”‘å¡å¦æ­£å¸¸æœç”¨ï¼Ÿ} |"))
#+end_src

*** ç¡çœ æƒ…å†µ

| è®°å½•æ—¥æœŸ | ç¡çœ æ—¶é•¿Â·å¤œ | ç¡çœ æ—¶é•¿Â·åˆ |

#+begin_src emacs-lisp
(add-to-list 'org-capture-templates
             '("b2"
               "ç¡çœ æƒ…å†µ"
               table-line
               (file+headline py/bipolar "ç¡çœ æƒ…å†µ")
               "| %t | %^{æ™šä¸Šç¡äº†å¤šä¹…ï¼Ÿ} | %^{ä¸­åˆç¡äº†å¤šä¹…ï¼Ÿ} |"))
#+end_src

*** æ€¥èº&ç„¦è™‘æƒ…å†µ

| è®°å½•æ—¥æœŸ | å¿ƒå¢ƒè¡¨æ ¼å¤‡æ³¨ | æ€¥èºç­‰çº§ | æ€¥èºå†…å®¹ | ç„¦è™‘ç­‰çº§ | ç„¦è™‘å†…å®¹ |

#+begin_src emacs-lisp
(add-to-list 'org-capture-templates
             '("b3"
               "æ€¥èº&ç„¦è™‘æƒ…å†µ"
               table-line
               (file+headline py/bipolar "æ€¥èº&ç„¦è™‘æƒ…å†µ")
               "| %t | %^{å¤‡æ³¨} | %^{æ€¥èºç­‰çº§ (1-10)} | %^{åŠæ—©å†…å®¹} | %^{å”‘å¡å¦æ­£å¸¸æœç”¨ï¼Ÿ} |"))
#+end_src

*** å·¥ä½œå†…å®¹è®°å½•

| è®°å½•æ—¥æœŸ | å·¥ä½œå†…å®¹1 | æ—¶é•¿ | å·¥ä½œå†…å®¹2 | æ—¶é•¿ | å·¥ä½œå†…å®¹3 | æ—¶é•¿ | å·¥ä½œå†…å®¹4 | æ—¶é•¿ |

#+begin_src emacs-lisp
(add-to-list 'org-capture-templates
             '("b4"
               "å·¥ä½œå†…å®¹è®°å½•"
               table-line
               (file+headline py/bipolar "å·¥ä½œå†…å®¹è®°å½•")
               "| %t | %^{å¤‡æ³¨} | %^{å·¥ä½œå†…å®¹1} | %^{æ—¶é•¿} | %^{å·¥ä½œå†…å®¹2} | %^{æ—¶é•¿} | %^{å·¥ä½œå†…å®¹3} | %^{æ—¶é•¿} | %^{å·¥ä½œå†…å®¹4} | %^{æ—¶é•¿} | "))
#+end_src

*** æŠ‘éƒ&èºç‹‚è®°å½•
:PROPERTIES:
:ID:       2a89219b-5fec-477e-be97-57beff1580ff
:END:

| è®°å½•æ—¥æœŸ | æŠ‘éƒç¨‹åº¦ | èºç‹‚ç¨‹åº¦ |


#+begin_src emacs-lisp
(add-to-list 'org-capture-templates
             '("b5"
               "æŠ‘éƒ&èºç‹‚è®°å½•"
               table-line
               (file+headline py/bipolar "æŠ‘éƒ&èºç‹‚è®°å½•")
               "| %t | %^{æŠ‘éƒç¨‹åº¦} | %^{èºç‹‚ç¨‹åº¦} |"))
#+end_src

*** ç²¾ç¥çŠ¶æ€ å¹»è§‰ æ€ªè¯æƒ³æ³•è®°å½•

| è®°å½•æ—¥æœŸ | ç²¾ç¥çŠ¶æ€ | å¹»è§‰ | æ€ªè¯æƒ³æ³• |

#+begin_src emacs-lisp
(add-to-list 'org-capture-templates
             '("b6"
               "ç²¾ç¥çŠ¶æ€ å¹»è§‰ æ€ªè¯æƒ³æ³•è®°å½•"
               table-line
               (file+headline py/bipolar "ç²¾ç¥çŠ¶æ€ å¹»è§‰ æ€ªè¯æƒ³æ³•è®°å½•")
               "| %t | %^{ç²¾ç¥çŠ¶æ€ï¼ˆéšä¾¿è¯´è¯´ï¼‰} | %^{å¹»è§‰ï¼Ÿ} | %^{æ€ªè¯æƒ³æ³•} |"))
#+end_src

*** å¿«ä¹äº‹ä»¶è®°å½•

| è®°å½•æ—¥æœŸ | å†…å®¹1 | æ—¶é•¿ | å†…å®¹2   | æ—¶é•¿ | å†…å®¹3   | æ—¶é•¿ | å†…å®¹4   | æ—¶é•¿ |

#+begin_src emacs-lisp
(add-to-list 'org-capture-templates
             '("b7"
               "å¿«ä¹äº‹ä»¶è®°å½•"
               table-line
               (file+headline py/bipolar "å¿«ä¹äº‹ä»¶è®°å½•")
               "| %t | %^{å†…å®¹1} | %^{æ—¶é•¿} | %^{å†…å®¹2} | %^{æ—¶é•¿} | %^{å†…å®¹3} | %^{æ—¶é•¿} | %^{å†…å®¹4}| %^{æ—¶é•¿} |"))
#+end_src

* Metacog

** Notes
*** ğŸ¬ TODO
:PROPERTIES:
:INIT:       [2021-04-13 Tue 18:53]
:END:
